# Git Secrets Pattern Configuration
# HoliLabs Security - Prevent Secret Commits
# Last Updated: December 15, 2025
#
# Installation:
#   brew install git-secrets
#   cd /path/to/holilabsv2
#   git secrets --install
#
# Add patterns from this file:
#   git secrets --add-provider -- cat .git-secrets-patterns.txt
#
# Or add individually:
#   git secrets --add 'pattern'

# ============================================================================
# OPENAI & ANTHROPIC API KEYS
# ============================================================================
# OpenAI: sk-proj-... or sk-...
sk-proj-[A-Za-z0-9_\-]{40,}
sk-[A-Za-z0-9_\-]{40,}

# Anthropic: sk-ant-api03-...
sk-ant-api03-[A-Za-z0-9_\-]{40,}

# Google AI API Key (40 characters alphanumeric)
AIzaSy[A-Za-z0-9_\-]{33}

# ============================================================================
# STRIPE PAYMENT KEYS
# ============================================================================
# Stripe Secret Key: sk_live_... or sk_test_...
sk_live_[A-Za-z0-9]{24,}
sk_test_[A-Za-z0-9]{24,}

# Stripe Restricted Key: rk_live_... or rk_test_...
rk_live_[A-Za-z0-9]{24,}
rk_test_[A-Za-z0-9]{24,}

# Stripe Publishable Key (for completeness, less critical)
pk_live_[A-Za-z0-9]{24,}
pk_test_[A-Za-z0-9]{24,}

# Stripe Webhook Secret: whsec_...
whsec_[A-Za-z0-9]{32,}

# ============================================================================
# TWILIO CREDENTIALS
# ============================================================================
# Twilio Account SID: AC followed by 32 hex chars
AC[a-f0-9]{32}

# Twilio Auth Token: 32 hex chars
# (Difficult to distinguish from other tokens, use with caution)
# twilio.*auth.*token.*[a-f0-9]{32}

# ============================================================================
# EMAIL SERVICE KEYS
# ============================================================================
# Resend API Key: re_...
re_[A-Za-z0-9]{20,}

# SendGrid API Key: SG...
SG\.[A-Za-z0-9_\-]{22,}

# ============================================================================
# AWS CREDENTIALS
# ============================================================================
# AWS Access Key ID: AKIA...
AKIA[A-Z0-9]{16}

# AWS Secret Access Key (40 characters base64-like)
# (AWS registers patterns for secret scanning)
[A-Za-z0-9/+=]{40}

# ============================================================================
# DATABASE CONNECTION STRINGS
# ============================================================================
# PostgreSQL with password: postgresql://user:password@host
postgresql://[a-zA-Z0-9_]+:[^@\s]+@

# MongoDB with password: mongodb://user:password@host
mongodb(\+srv)?://[a-zA-Z0-9_]+:[^@\s]+@

# Redis with password: redis://:password@host
redis://:[^@\s]+@

# ============================================================================
# GENERIC SECRET PATTERNS
# ============================================================================
# Private keys (PEM format)
-----BEGIN (RSA |EC )?PRIVATE KEY-----

# JWT tokens (long base64 strings with dots)
eyJ[A-Za-z0-9_\-]*\.[A-Za-z0-9_\-]*\.[A-Za-z0-9_\-]*

# Long hex strings (potential encryption keys - 64+ chars)
[0-9a-f]{64,}

# Base64 encoded secrets (64+ chars, typical for encryption keys)
[A-Za-z0-9+/]{64,}={0,2}

# Bearer tokens in Authorization headers
Bearer [A-Za-z0-9_\-\.]{20,}

# ============================================================================
# HOLILABS-SPECIFIC PATTERNS
# ============================================================================
# Environment variable assignments with actual values (not placeholders)
# This catches lines like: API_KEY="sk-real-key-here"
# But allows: API_KEY="your-api-key-here" (placeholder)
# Note: This is a complex pattern and may have false positives

# Admin API keys (32-64 hex characters)
ADMIN_API_KEY="[0-9a-f]{32,}"

# Session secrets (32-64 hex characters)
SESSION_SECRET="[0-9a-f]{32,}"
NEXTAUTH_SECRET="[0-9a-f]{32,}"

# Encryption keys (base64, 32+ characters)
ENCRYPTION_KEY="[A-Za-z0-9+/]{32,}={0,2}"
ENCRYPTION_MASTER_KEY="[A-Za-z0-9+/]{32,}={0,2}"

# Opt-out secret keys
OPT_OUT_SECRET_KEY="[0-9a-f]{32,}"

# Meilisearch master keys
MEILI_MASTER_KEY="[A-Za-z0-9+/]{32,}={0,2}"

# Cron secrets
CRON_SECRET="[0-9a-f]{32,}"

# DEID secrets
DEID_SECRET="[0-9a-f]{32,}"

# ============================================================================
# DEEPGRAM & ASSEMBLYAI (SPEECH-TO-TEXT)
# ============================================================================
# Deepgram API Key (32 hex characters)
[0-9a-f]{32}

# AssemblyAI API Key
[a-f0-9]{32}

# ============================================================================
# MONITORING & LOGGING
# ============================================================================
# Sentry DSN (contains secret token)
https://[a-f0-9]+@[a-z0-9\-]+\.ingest\.sentry\.io/[0-9]+

# Sentry Auth Token
[a-f0-9]{64}

# Logtail/BetterStack Source Token
[A-Za-z0-9]{20,}

# PostHog Project Key: phc_...
phc_[A-Za-z0-9]{43}

# ============================================================================
# SLACK & PAGERDUTY
# ============================================================================
# Slack Webhook URL
https://hooks\.slack\.com/services/T[A-Z0-9]+/B[A-Z0-9]+/[A-Za-z0-9]{24}

# Slack API Token: xoxb-... or xoxp-...
xox[baprs]-[0-9]{10,}-[0-9]{10,}-[A-Za-z0-9]{24,}

# PagerDuty Integration Key
[a-f0-9]{32}

# ============================================================================
# MEXICAN TAX COMPLIANCE (CFDI/PAC)
# ============================================================================
# Private key passwords (not base64 encoded)
PAC_PRIVATE_KEY_PASSWORD=".{8,}"

# Certificate data (base64 - very long)
PAC_CERTIFICATE="[A-Za-z0-9+/]{100,}={0,2}"

# ============================================================================
# TESTING PATTERNS
# ============================================================================
# To test if patterns work:
#   echo "sk-proj-1234567890abcdefghijklmnopqrstuvwxyz123456" | git secrets --scan -
# Should output: [SECRETS] Found verboten string...

# To allow specific false positives:
#   git secrets --add --allowed 'allowed-pattern-here'

# Examples of allowed patterns (add as needed):
# git secrets --add --allowed 'sk-ant-api03-1234567890'  # Test fixture
# git secrets --add --allowed 'your-api-key-here'        # Placeholder in .env.example
# git secrets --add --allowed 'your-secret-here'         # Placeholder in .env.example

# ============================================================================
# ALLOWED PATTERNS (FALSE POSITIVE EXCEPTIONS)
# ============================================================================
# These patterns should be ALLOWED even if they match above rules
# Add these with: git secrets --add --allowed 'pattern'

# Test fixtures and examples
sk-ant-api03-1234567890
sk-test-example
your-api-key-here
your-secret-here
your-token-here
example-api-key
test-api-key
placeholder
change-me
replace-me
generate-with

# Documentation examples (obvious fake values)
ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
postgresql://user:password@
mongodb://user:password@

# UUIDs and common IDs (not secrets)
VBQ-[A-Z]{2}-[0-9]{4}-[A-Z]{3}

# ============================================================================
# NOTES
# ============================================================================
# 1. These patterns are regex-based and may have false positives
# 2. Always review git-secrets output before force-adding exceptions
# 3. Update this file when adding new secret types to the application
# 4. Test new patterns thoroughly before committing
# 5. Keep this file under version control for team consistency

# Last reviewed: December 15, 2025
# Maintained by: Security Team
