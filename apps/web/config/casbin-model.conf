# Casbin RBAC with Domain Model
# SOC 2 Control: CC6.3 (Authorization & Principle of Least Privilege)
#
# This model supports:
# - Role-Based Access Control (RBAC)
# - Role Hierarchy (ADMIN inherits PHYSICIAN permissions)
# - Attribute-Based Access Control (ABAC) with conditions
# - Multi-tenancy with domains (organizations)
#
# Policy Format:
# p, subject, object, action, [domain], [condition]
# g, user, role, [domain]
#
# Examples:
# p, PHYSICIAN, patients, read, *, *                    # All physicians can read patients
# p, PHYSICIAN, patients, write, *, owner               # Only if physician is patient owner
# g, ADMIN, PHYSICIAN, *                                # ADMIN inherits all PHYSICIAN permissions
# g, user_123, PHYSICIAN, org_456                       # user_123 is PHYSICIAN in org_456

[request_definition]
r = sub, obj, act, dom

[policy_definition]
p = sub, obj, act, dom, eft

[role_definition]
g = _, _, _

[policy_effect]
e = some(where (p.eft == allow)) && !some(where (p.eft == deny))

[matchers]
m = g(r.sub, p.sub, r.dom) && r.obj == p.obj && r.act == p.act && (r.dom == p.dom || p.dom == "*")
