# ============================================================================
# HOLI LABS - PRODUCTION ENVIRONMENT VARIABLES
# ============================================================================
#
# 🔒 SECURITY WARNING:
# - This file contains production configuration
# - DO NOT commit actual secret values to git
# - Use DigitalOcean App Platform environment variables for secrets
# - This template shows structure and documentation only
#
# 📋 USAGE:
# - Copy this file to create your production .env
# - Replace all placeholder values with real values
# - Add to DigitalOcean: Apps → Settings → Environment Variables
#
# ⏱️  ESTIMATED SETUP TIME: 90 minutes
# 📊 COMPLETION RATE: Use `npx tsx scripts/audit-environment.ts` to check
#
# Generated: October 25, 2025
# Version: 1.0.0
# Status: Template (needs configuration)
#
# ============================================================================

# ============================================================================
# 🔴 CRITICAL - REQUIRED FOR APPLICATION TO START
# ============================================================================

# ────────────────────────────────────────────────────────────────────────────
# DATABASE (CRITICAL)
# ────────────────────────────────────────────────────────────────────────────
# Purpose: PostgreSQL database connection
# Where to get: DigitalOcean → Databases → Select cluster → Connection Details
# Format: postgresql://username:password@host:port/database?sslmode=require
# HIPAA: ✅ Must use managed database with SSL
# ────────────────────────────────────────────────────────────────────────────
DATABASE_URL="postgresql://username:password@host:port/holi_labs?schema=public&sslmode=require"

# ────────────────────────────────────────────────────────────────────────────
# AUTHENTICATION (CRITICAL)
# ────────────────────────────────────────────────────────────────────────────
# Purpose: NextAuth session signing and encryption
# How to generate:
#   NEXTAUTH_SECRET: openssl rand -hex 32
#   SESSION_SECRET: openssl rand -hex 32
# HIPAA: ✅ Required for secure session management
# Rotation: Every 30 days
# ────────────────────────────────────────────────────────────────────────────

# NextAuth secret (64-character hex string)
# Example: d7f6464bd1b7d4380f2b74350692eace34e58ec27ce2ae77a66e2cfa6c45c032
NEXTAUTH_SECRET="your-nextauth-secret-64-char-hex"

# NextAuth production URL (must match deployment URL)
# Example: https://holilabs-lwp6y.ondigitalocean.app
NEXTAUTH_URL="https://your-app.ondigitalocean.app"

# Session encryption secret (64-character hex string)
# Example: 287dd2c3bb327618deb091442bf66b7c39fc4e5e89036253dfcac0b32f3c0458
SESSION_SECRET="your-session-secret-64-char-hex"

# ────────────────────────────────────────────────────────────────────────────
# SUPABASE (CRITICAL)
# ────────────────────────────────────────────────────────────────────────────
# Purpose: Authentication and file storage
# Where to get: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api
# HIPAA: ⚠️  Requires Enterprise plan ($599/month) with BAA
# Note: BAA signing is REQUIRED before processing PHI
# ────────────────────────────────────────────────────────────────────────────

# Supabase project URL
# Example: https://yyteqajwjjrubiktornb.supabase.co
NEXT_PUBLIC_SUPABASE_URL="https://your-project.supabase.co"

# Supabase anonymous key (public, safe to expose)
# Example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
NEXT_PUBLIC_SUPABASE_ANON_KEY="your-supabase-anon-key"

# Supabase service role key (SECRET, admin access)
# ⚠️  WARNING: This key bypasses all RLS policies
# Example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
SUPABASE_SERVICE_ROLE_KEY="your-supabase-service-role-key"

# ────────────────────────────────────────────────────────────────────────────
# ENCRYPTION (CRITICAL)
# ────────────────────────────────────────────────────────────────────────────
# Purpose: AES-256 encryption for PHI (Protected Health Information)
# How to generate: openssl rand -base64 32
# HIPAA: ✅ Required for PHI encryption at rest
# Rotation: Every 180 days (requires re-encryption of all data!)
# ⚠️  CRITICAL: Never lose this key or data cannot be decrypted
# ────────────────────────────────────────────────────────────────────────────

# Encryption master key (32-byte base64 string)
# Example: oKk4xJchl5R13mpQngudsTSui5l+BA/54iIzdnwXkbI=
ENCRYPTION_KEY="your-32-byte-encryption-key-base64"

# ────────────────────────────────────────────────────────────────────────────
# APPLICATION (CRITICAL)
# ────────────────────────────────────────────────────────────────────────────
# Purpose: Core application configuration
# ────────────────────────────────────────────────────────────────────────────

# Production app URL (must match actual deployment)
# Example: https://holilabs-lwp6y.ondigitalocean.app
NEXT_PUBLIC_APP_URL="https://your-app.ondigitalocean.app"

# Node environment (MUST be "production" in production)
NODE_ENV="production"

# ============================================================================
# 🟡 HIGH PRIORITY - REQUIRED FOR CORE FEATURES
# ============================================================================

# ────────────────────────────────────────────────────────────────────────────
# SECURITY
# ────────────────────────────────────────────────────────────────────────────
# Purpose: Additional security tokens
# How to generate: openssl rand -hex 32
# ────────────────────────────────────────────────────────────────────────────

# Cron job authentication (64-character hex)
# Used to secure /api/cron/* endpoints
CRON_SECRET="your-cron-secret-64-char-hex"

# De-identification secret (64-character hex)
# Used for anonymizing patient data in analytics
# HIPAA: ✅ Required for HIPAA-compliant analytics
DEID_SECRET="your-deid-secret-64-char-hex"

# ────────────────────────────────────────────────────────────────────────────
# AI SERVICES
# ────────────────────────────────────────────────────────────────────────────
# Purpose: AI-powered clinical decision support and transcription
# HIPAA: ⚠️  Anthropic BAA required (available on request)
# ────────────────────────────────────────────────────────────────────────────

# Anthropic Claude API key (PRIMARY AI provider)
# Where to get: https://console.anthropic.com/settings/keys
# Usage: SOAP note generation, clinical decision support
# Cost: ~$3 per 1M input tokens, ~$15 per 1M output tokens
# HIPAA: Sign BAA at https://www.anthropic.com/contact-sales
ANTHROPIC_API_KEY="sk-ant-your-anthropic-api-key"

# AI configuration
AI_PRIMARY_PROVIDER="claude"
AI_FALLBACK_ENABLED="true"
AI_CACHE_ENABLED="true"
AI_CACHE_TTL="86400"
AI_RATE_LIMIT_PER_USER="50"

# AI usage quotas (freemium model)
AI_FREE_TIER_LIMIT="10"
AI_STARTER_TIER_LIMIT="50"
AI_PRO_TIER_LIMIT="999999"

# Cost monitoring
AI_MONTHLY_BUDGET_USD="500"
AI_ALERT_THRESHOLD_PERCENT="80"

# ────────────────────────────────────────────────────────────────────────────
# EMAIL SERVICE
# ────────────────────────────────────────────────────────────────────────────
# Purpose: Transactional emails (appointment reminders, password reset, etc.)
# Provider: Resend (https://resend.com)
# Cost: $20/month for 50k emails
# HIPAA: ⚠️  Check with Resend if BAA is available
# ────────────────────────────────────────────────────────────────────────────

# Resend API key
# Where to get: https://resend.com/api-keys
# ⚠️  If previous key was exposed, REVOKE IT FIRST
RESEND_API_KEY="re_your_production_resend_key"

# ────────────────────────────────────────────────────────────────────────────
# PUSH NOTIFICATIONS
# ────────────────────────────────────────────────────────────────────────────
# Purpose: Web push notifications for appointment reminders
# How to generate: npx web-push generate-vapid-keys
# HIPAA: ✅ Compliant (encrypted, no PHI in notification body)
# ────────────────────────────────────────────────────────────────────────────

# VAPID public key (public, safe to expose)
# Example: BEl62iUYgUivxIkv69yViEuiBIa-Ib9-SkvMeAtA3LFgDzk...
NEXT_PUBLIC_VAPID_PUBLIC_KEY="your-vapid-public-key"

# VAPID private key (SECRET)
# Example: UUxI4O8-FbRouAevSmBQ6o18hgE4nSG3qwvJTfKc-ls
VAPID_PRIVATE_KEY="your-vapid-private-key"

# VAPID subject (contact email)
# Example: mailto:admin@holilabs.com
VAPID_SUBJECT="mailto:admin@holilabs.com"

# ────────────────────────────────────────────────────────────────────────────
# ERROR MONITORING
# ────────────────────────────────────────────────────────────────────────────
# Purpose: Real-time error tracking and performance monitoring
# Provider: Sentry (https://sentry.io)
# HIPAA: ⚠️  PHI scrubbing REQUIRED (configured in sentry.*.config.ts)
# ────────────────────────────────────────────────────────────────────────────

# Sentry DSN (public, safe to expose)
# Where to get: Sentry → Project Settings → Client Keys (DSN)
# Example: https://abc123@o123456.ingest.sentry.io/789012
NEXT_PUBLIC_SENTRY_DSN="https://your-sentry-dsn@sentry.io/your-project"

# Sentry auth token (for release tracking - OPTIONAL)
# Where to get: Sentry → Settings → Auth Tokens
SENTRY_AUTH_TOKEN="your-sentry-auth-token"

# Sentry organization and project
SENTRY_ORG="holi-labs"
SENTRY_PROJECT="holi-labs-web"

# Suppress warning about global error handler
SENTRY_SUPPRESS_GLOBAL_ERROR_HANDLER_FILE_WARNING="1"

# App version for release tracking
NEXT_PUBLIC_APP_VERSION="1.0.0"

# ────────────────────────────────────────────────────────────────────────────
# ANALYTICS
# ────────────────────────────────────────────────────────────────────────────
# Purpose: Product analytics, A/B testing, feature flags
# Provider: PostHog (https://posthog.com)
# HIPAA: ✅ Free BAA available (contact hey@posthog.com)
# IMPORTANT: Use US region and disable auto-capture for HIPAA compliance
# ────────────────────────────────────────────────────────────────────────────

# PostHog project API key
# Where to get: PostHog → Project Settings → Project API Key
# Example: phc_abc123def456ghi789jkl012mno345pqr678stu901vwx234yz
NEXT_PUBLIC_POSTHOG_KEY="phc_your_posthog_project_key"

# PostHog host (MUST use US region for HIPAA)
# ⚠️  Do NOT use eu.i.posthog.com
NEXT_PUBLIC_POSTHOG_HOST="https://us.i.posthog.com"

# ============================================================================
# 🔵 MEDIUM PRIORITY - OPTIONAL BUT RECOMMENDED
# ============================================================================

# ────────────────────────────────────────────────────────────────────────────
# AI SERVICES (OPTIONAL - FALLBACK PROVIDERS)
# ────────────────────────────────────────────────────────────────────────────

# Google Gemini API key (FALLBACK #1)
# Where to get: https://console.cloud.google.com/apis/credentials
# Cost: Cheaper than Anthropic (~$0.50/1M tokens)
# GOOGLE_AI_API_KEY="your-google-ai-api-key"

# OpenAI GPT-4 API key (FALLBACK #2)
# Where to get: https://platform.openai.com/api-keys
# Cost: Most expensive (~$10/1M input, ~$30/1M output)
# OPENAI_API_KEY="sk-your-openai-api-key"

# Deepgram API key (for medical transcription)
# Where to get: https://console.deepgram.com/
# Cost: $0.0125 per minute
# DEEPGRAM_API_KEY="your-deepgram-api-key"

# AssemblyAI API key (alternative transcription)
# Where to get: https://www.assemblyai.com/app/account
# ⚠️  Previous key was exposed - generate new one
# ASSEMBLYAI_API_KEY="your-new-assemblyai-api-key"

# ────────────────────────────────────────────────────────────────────────────
# SMS & WHATSAPP
# ────────────────────────────────────────────────────────────────────────────
# Purpose: Appointment reminders via SMS/WhatsApp
# Provider: Twilio (https://twilio.com)
# HIPAA: ✅ BAA available (self-service signup)
# ────────────────────────────────────────────────────────────────────────────

# Twilio credentials
# Where to get: https://console.twilio.com
# TWILIO_ACCOUNT_SID="your-twilio-account-sid"
# TWILIO_AUTH_TOKEN="your-twilio-auth-token"
# TWILIO_PHONE_NUMBER="+15551234567"
# TWILIO_WHATSAPP_NUMBER="whatsapp:+14155238886"

# ────────────────────────────────────────────────────────────────────────────
# PAYMENTS
# ────────────────────────────────────────────────────────────────────────────
# Purpose: Patient payments for consultations and services
# Provider: Stripe (https://stripe.com)
# ⚠️  USE PRODUCTION KEYS, NOT TEST KEYS
# HIPAA: ✅ BAA included (contact Stripe support to sign)
# ────────────────────────────────────────────────────────────────────────────

# Stripe secret key (starts with sk_live_ in production)
# Where to get: https://dashboard.stripe.com/apikeys
# ⚠️  Replace sk_test_ with sk_live_
# STRIPE_SECRET_KEY="sk_live_your_production_stripe_secret_key"

# Stripe publishable key (starts with pk_live_ in production)
# NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY="pk_live_your_production_stripe_publishable_key"

# Stripe webhook secret
# Where to get: Stripe → Webhooks → Add endpoint
# STRIPE_WEBHOOK_SECRET="whsec_your_production_webhook_secret"

# ────────────────────────────────────────────────────────────────────────────
# RATE LIMITING
# ────────────────────────────────────────────────────────────────────────────
# Purpose: Prevent API abuse and brute-force attacks
# Provider: Upstash Redis (https://upstash.com)
# Cost: Free tier (10k commands/day), then $0.20 per 100k commands
# Recommended: Yes (especially for production)
# ────────────────────────────────────────────────────────────────────────────

# Upstash Redis REST API
# Where to get: https://console.upstash.com → Select database → REST API
# UPSTASH_REDIS_REST_URL="https://your-redis.upstash.io"
# UPSTASH_REDIS_REST_TOKEN="your-upstash-rest-token"

# ────────────────────────────────────────────────────────────────────────────
# CLOUD STORAGE (OPTIONAL)
# ────────────────────────────────────────────────────────────────────────────
# Purpose: Store medical images, documents, backups
# Provider: Cloudflare R2 or AWS S3
# Note: Supabase Storage can also be used
# ────────────────────────────────────────────────────────────────────────────

# Cloudflare R2 (S3-compatible, cheaper than AWS)
# Where to get: https://dash.cloudflare.com → R2 → Create bucket
# R2_ENDPOINT="https://your-account-id.r2.cloudflarestorage.com"
# R2_BUCKET="holi-labs-documents"
# R2_ACCESS_KEY_ID="your-r2-access-key"
# R2_SECRET_ACCESS_KEY="your-r2-secret-key"

# OR use AWS S3
# S3_ENDPOINT="https://s3.amazonaws.com"
# S3_BUCKET="holi-labs-documents"
# AWS_ACCESS_KEY_ID="your-aws-access-key"
# AWS_SECRET_ACCESS_KEY="your-aws-secret-key"

# ============================================================================
# ⚪ LOW PRIORITY - OPTIONAL FEATURES
# ============================================================================

# ────────────────────────────────────────────────────────────────────────────
# CFDI (MEXICAN TAX COMPLIANCE)
# ────────────────────────────────────────────────────────────────────────────
# Purpose: Generate SAT-compliant electronic invoices (Mexico only)
# Required: Only if operating in Mexico
# ────────────────────────────────────────────────────────────────────────────

# Holi Labs RFC (tax ID)
# HOLI_LABS_RFC="HOL123456ABC"

# PAC provider (Proveedor Autorizado de Certificación)
# Options: finkok, sw-sapien, diverza, ecodex
# PAC_PROVIDER="finkok"

# PAC API endpoint
# PAC_API_URL="https://facturacion.finkok.com/servicios/soap"

# PAC credentials
# PAC_USERNAME="your-pac-username"
# PAC_PASSWORD="your-pac-password"

# CSD certificate and private key (Base64 encoded)
# PAC_CERTIFICATE=""
# PAC_PRIVATE_KEY=""
# PAC_PRIVATE_KEY_PASSWORD=""

# ────────────────────────────────────────────────────────────────────────────
# BLOCKCHAIN (OPTIONAL)
# ────────────────────────────────────────────────────────────────────────────
# Purpose: Immutable audit trail for medical records
# Note: Experimental feature, not required for HIPAA compliance
# ────────────────────────────────────────────────────────────────────────────

# Enable blockchain features (default: false)
# ENABLE_BLOCKCHAIN="false"

# Polygon RPC URL
# POLYGON_RPC_URL="https://polygon-mainnet.g.alchemy.com/v2/your-key"

# Smart contract address
# HEALTH_CONTRACT_ADDRESS="0x0000000000000000000000000000000000000000"

# Private key for blockchain transactions
# ⚠️  CRITICAL: Keep this secret, do not expose
# BLOCKCHAIN_PRIVATE_KEY="your-private-key"

# ────────────────────────────────────────────────────────────────────────────
# SECURITY
# ────────────────────────────────────────────────────────────────────────────

# Allowed origins for CORS (comma-separated)
ALLOWED_ORIGINS="https://holilabs-lwp6y.ondigitalocean.app,https://holilabs.com,https://www.holilabs.com"

# ────────────────────────────────────────────────────────────────────────────
# LOGGING
# ────────────────────────────────────────────────────────────────────────────

# Log level (error, warn, info, debug)
LOG_LEVEL="info"

# ============================================================================
# END OF PRODUCTION ENVIRONMENT VARIABLES
# ============================================================================
#
# 📊 CONFIGURATION CHECKLIST:
# - [ ] All CRITICAL variables configured (9 required)
# - [ ] All HIGH priority variables configured (11 required)
# - [ ] Supabase BAA signed ($599/month Enterprise plan)
# - [ ] DigitalOcean BAA signed ($40/month Business Plus plan)
# - [ ] PostHog BAA signed (Free, contact hey@posthog.com)
# - [ ] Anthropic BAA requested (Free for API usage)
# - [ ] PHI scrubbing configured in Sentry
# - [ ] Auto-capture disabled in PostHog
# - [ ] All secrets added to DigitalOcean environment variables
# - [ ] Production deployment tested
#
# 🔄 NEXT STEPS:
# 1. Copy secrets from .env.production.secrets.template (lines 92-96)
# 2. Get Supabase keys from dashboard
# 3. Get API keys from service providers
# 4. Add all variables to DigitalOcean App Platform
# 5. Run: npx tsx scripts/audit-environment.ts
# 6. Deploy and test
#
# 📚 DOCUMENTATION:
# - Environment Status: ENVIRONMENT_STATUS.md
# - Comparison Matrix: ENVIRONMENT_COMPARISON_MATRIX.md
# - Secrets Guide: SECRETS_GENERATION.md
# - Deployment Checklist: DEPLOYMENT_SECRETS_CHECKLIST.md
#
# ⏱️  ESTIMATED TIME TO COMPLETE: ~90 minutes
#
# ============================================================================
